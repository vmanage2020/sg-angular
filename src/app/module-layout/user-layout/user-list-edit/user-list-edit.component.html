<app-ui-preloader [display]="loading" *ngIf="displayLoader"></app-ui-preloader>
<div class="row">
        <div class="col-lg-6">
            <div class="card-box">
                <h4 class="header-title mb-4" >Update User</h4>
                <h5 class="text-uppercase bg-light p-2 mt-0 mb-3">User Details</h5>
                
                <form class="needs-validation" name="createuserForm" [formGroup]="createuserForm" (ngSubmit)="onSubmit(createuserForm)" novalidate>

                    
                <div class="form-group mb-3">
                    <label for="product-reference">Role <span class="text-danger">*</span></label>
                    <br/>
                    
                     <div class="paddingTopForRoleCreate d-flex">
                        <div *ngFor="let role of roleList;let i = index" >
                            
                             <div *ngIf="rolesArrayList.includes(role.role_id)" >

                                <div class="custom-control custom-checkbox pr-1" >
                                <input type="checkbox" #checkboxes class="custom-control-input" [id]="role.role_id" 
                                checked="checked"
                                [value]="role.role_id" (click)="selectedRole($event,createUserForm)">
                                    <label class="custom-control-label" [for]="role.role_id">{{role.name}} </label>
                                </div>

                            </div>

                            
                            <div *ngIf="!rolesArrayList.includes(role.role_id)" >

                                <div class="custom-control custom-checkbox pr-1" >
                                <input type="checkbox" #checkboxes class="custom-control-input" [id]="role.role_id" 
                                [value]="role.role_id" (click)="selectedRole($event,createUserForm)">
                                    <label class="custom-control-label" [for]="role.role_id">{{role.name}} </label>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div *ngIf="submitted && f.roles?.errors" class="invalid-feedback">
                        <div *ngIf="f.roles?.errors?.required">Need to be choosen.</div>
                    </div>  
                
                </div>

                <div class="form-group mb-3">
                    <label for="first_name">First Name<span class="text-danger">*</span></label>
                    <input type="text" readonly id="first_name" name="first_name" formControlName="first_name" class="form-control" placeholder="Enter first name" [ngClass]="{ 'is-invalid': submitted && f.first_name.errors }"/>
                    <div *ngIf="submitted && f.first_name.errors" class="invalid-feedback">
                        <div *ngIf="f.first_name.errors.required">First Name is required.</div>
                        <p class="error text-danger" *ngIf="f.first_name.errors?.pattern">Firstname must be Alphabets only</p>
                    </div>               
                </div>

                <div class="form-group mb-3">
                    <label for="middle_initial">Middle Initial</label>
                    <input type="text" readonly id="middle_initial" name="middle_initial" formControlName="middle_initial" class="form-control" placeholder="Enter middle initial" [ngClass]="{ 'is-invalid': submitted && f.middle_initial.errors }" />
                    <div *ngIf="submitted && f.middle_initial.errors" class="invalid-feedback">
                        <div *ngIf="f.middle_initial.errors">Maximum three characters allowed.</div>
                        <p class="error text-danger" *ngIf="f.middle_initial.errors?.pattern">Only text characters are allowed.</p>
                    </div>
                </div>

                
                <div class="form-group mb-3">
                    <label for="last_name">Last Name<span class="text-danger">*</span></label>
                    <input type="text" readonly id="last_name" name="last_name" formControlName="last_name" class="form-control" placeholder="Enter last name" [ngClass]="{ 'is-invalid': submitted && f.last_name.errors }"/>
                    <div *ngIf="submitted && f.last_name.errors" class="invalid-feedback">
                        <div *ngIf="f.last_name.errors.required">Last Name is required.</div>
                        <p class="error text-danger" *ngIf="f.last_name.errors?.pattern">Lastname must be Alphabets only</p>
                    </div>                
                </div>

                
                <div class="form-group mb-3">
                    <!-- <div class="col-3 mt-2 label-border-height allColMaxWidth">
                        <label class="for-label-req" for="date_of_birth">Date Of Birth</label>
                    </div> -->
                    <label for="suffix">Date Of Birth</label>
                    <div class="col-12 mt-2" id="customHeight">
                        <div class="input-group add-on date datepicker">
                           <!--  <input type="text" class="form-control date-picker" ngbDatepicker #d="ngbDatepicker"
                                class="form-control" placeholder="Choose date of birth "
                                formControlName="date_of_birth" (change)=ageValidation($event.target.value)
                                [ngClass]="{ 'is-invalid': submitted && f.date_of_birth.errors }"
                                name="date_of_birth"> -->

                                <input class="form-control" placeholder="Choose date of birthd"
                                    name="date_of_birth"  
                                    formControlName="date_of_birth" 
                                   
                                    ngbDatepicker #d="ngbDatepicker">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"></button>
                                </div>
                           
                            <!-- <div *ngIf="submitted && f.date_of_birth.errors" class="invalid-feedback">
                                <div *ngIf="f.date_of_birth.errors.required">Date Of Birth is required.
                                </div>
                            </div> -->

                        </div>
                    </div>                   
                </div>

                <div class="form-group mb-3">
                    <label for="email">Street Address1<span class="text-danger"></span></label>
                    <input type="text"  id="street1" name="street1" formControlName="street1" 
                    class="form-control" placeholder="Enter street1" 
                    [ngClass]="{ 'is-invalid': submitted && f.street1.errors }"/>
                    <div *ngIf="submitted && f.street1.errors" class="invalid-feedback">
                        <div *ngIf="f.street1.errors.required">Address1 is required.</div>
                    </div>                
                </div>

                <div class="form-group mb-3">
                    <label for="email">Street Address2<span class="text-danger"></span></label>
                    <input type="text"  id="street2" name="street2" formControlName="street2" 
                    class="form-control" placeholder="Enter street2" 
                    [ngClass]="{ 'is-invalid': submitted && f.street2.errors }"/>
                    <div *ngIf="submitted && f.street2.errors" class="invalid-feedback">
                        <div *ngIf="f.street2.errors.required">Address2 is required.</div>
                    </div>                
                </div>

                <div class="form-group mb-3">
                    <label for="email">City<span class="text-danger"></span></label>
                    <input type="text"  id="city" name="city" formControlName="city" 
                    class="form-control" placeholder="Enter City " 
                    [ngClass]="{ 'is-invalid': submitted && f.city.errors }"/>
                    <div *ngIf="submitted && f.city.errors" class="invalid-feedback">
                        <div *ngIf="f.city.errors.required">city is required.</div>
                    </div>                
                </div>
                
                <div class="form-group mb-3">
                    <label for="email">State<span class="text-danger"></span></label>

                    <ng-select [items]="stateList"
                        bindLabel="name" bindValue="state_code"
                        id="state" name="state" formControlName="state"
                        placeholder="Select State" [ngClass]="{ 'is-invalid': submitted && f.state.errors }">
                        </ng-select> 
                    
                    <div *ngIf="submitted && f.state.errors" class="invalid-feedback">
                        <div *ngIf="f.state.errors.required">state is required.</div>
                    </div>                
                </div>

                <div class="form-group mb-3">
                    <label for="suffix">Country</label>
                    <ng-select [items]="countryList"
                    bindLabel="name" bindValue="country_code"
                    id="country_code" (change)="selectedCountry($event)" name="country_code" formControlName="country_code"
                    placeholder="Select Country" [ngClass]="{ 'is-invalid': submitted && f.country_code.errors }">
                    </ng-select> 
                </div> 


                <div class="form-group mb-3">
                    <label for="email">Postal code<span class="text-danger"></span></label>
                    <input type="text" id="postal_code" name="postal_code" 
                    formControlName="postal_code" class="form-control" 
                    placeholder="Enter postal code" [ngClass]="{ 'is-invalid': submitted && f.postal_code.errors }"/>
                    <div *ngIf="submitted && f.postal_code.errors" class="invalid-feedback">
                        <div *ngIf="f.postal_code.errors.required">postal code is required.</div>
                    </div>                
                </div>


                <div class="form-group mb-3">
                    <label for="email">Phone<span class="text-danger"></span></label><br/>

                    <div class="col-2 p-0" id="customHeight" style="float: left;">
                        <input type="text" [value]="dialCode" formControlName="dialcode" class="form-control" readonly />
                    </div>
                    <div class="col-10 p-0" id="customHeight" style="float: left;">
                        <input type="text" formControlName="mobile_phone" class="form-control" data-toggle="input-mask" (input)="closeErrors('Phone')"
                          mask="(000) 000-0000" [ngClass]="{ 'is-invalid': submitted && f.mobile_phone.errors }" name="mobile_phone"
                          id="mobile_phone" placeholder="Enter phone number" />
                    <!--
                            <input type="text"  id="mobile_phone" name="mobile_phone" formControlName="mobile_phone" class="form-control" placeholder="Enter email address" [ngClass]="{ 'is-invalid': submitted && f.email.errors }"/>
                    -->
                    </div>
                    <div *ngIf="submitted && f.mobile_phone.errors" class="invalid-feedback">
                        <div *ngIf="f.mobile_phone.errors.required">mobile phone is required.</div>
                    </div>                
                </div>
                
                <div class="form-group mb-3">
                    <label for="suffix">Suffix</label>
                    <select class="form-control select2" id="suffix" name="suffix" formControlName="suffix"  >
                        <option value="" disabled selected>Select suffix</option>
                        <option *ngFor="let Typedata of getUserSuffixDataArray let i = index;" [ngValue]="Typedata.name">{{Typedata.name}}</option>
                    </select>
                </div> 
             
                <div class="form-group mb-3">
                    <label for="email">Email Address<span class="text-danger">*</span></label>
                    <input type="text"  readonly id="email" name="email" formControlName="email" class="form-control" placeholder="Enter email address" [ngClass]="{ 'is-invalid': submitted && f.email.errors }"/>
                    <div *ngIf="submitted && f.email.errors" class="invalid-feedback">
                        <div *ngIf="f.email.errors.required">Email is required.</div>
                        <div *ngIf="f.email.errors?.pattern">Enter a valid email address.</div>
                    </div>                
                </div>

                <div class="col-12">
                    <div class="text-center mb-3">
                        <button (click)="listUser()" type="button" class="btn w-sm btn-light waves-effect" style="float: left;">Cancel</button>
                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="submit" class="btn w-sm btn-success ml-1" style="float: right;">Save</button>
                    </div>
                </div> <!-- end col -->
    
            </form>    
            </div> <!-- end card-box -->
        </div> <!-- end col -->
 
    </div>
    <!-- end row -->